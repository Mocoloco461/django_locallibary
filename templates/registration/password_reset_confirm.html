{% extends "base_generic.html" %}

{% block title %}בחרו סיסמה חדשה{% endblock %}

{% block content %}
  {% if validlink %}
    <section class="form-card">
      <h2>קבעו סיסמה חדשה</h2>
      <p class="form-text mb-4">
        הסיסמה החדשה תחליף את הסיסמה הקיימת ותעניק לכם גישה לכלל שירותי הספרייה.
      </p>

      <form action="" method="post" class="d-grid gap-3">
        {% csrf_token %}

        <div>
          {% if form.new_password1.errors %}
            <div class="alert alert-danger" role="alert">
              {% for error in form.new_password1.errors %}
                <div>{{ error }}</div>
              {% endfor %}
            </div>
          {% endif %}
          <label class="form-label fw-semibold" for="id_new_password1">סיסמה חדשה</label>
          {{ form.new_password1 }}
        </div>

        <div>
          {% if form.new_password2.errors %}
            <div class="alert alert-danger" role="alert">
              {% for error in form.new_password2.errors %}
                <div>{{ error }}</div>
              {% endfor %}
            </div>
          {% endif %}
          <label class="form-label fw-semibold" for="id_new_password2">אימות סיסמה</label>
          {{ form.new_password2 }}
        </div>

        <button type="submit" class="btn btn-primary btn-lg">
          <i class="bi bi-shield-lock me-2"></i>שמרו סיסמה חדשה
        </button>
      </form>
    </section>
  {% else %}
    <section class="form-card text-center">
      <h2 class="mb-3 text-danger">קישור איפוס לא תקף</h2>
      <p class="text-secondary mb-4">
        נראה שהקישור כבר נוצל או שתוקפו פג. בקשו קישור חדש כדי להמשיך בתהליך.
      </p>
      <a class="btn btn-primary btn-lg" href="{% url 'password_reset' %}">
        שלחו לי קישור חדש
      </a>
    </section>
  {% endif %}
{% endblock %}
